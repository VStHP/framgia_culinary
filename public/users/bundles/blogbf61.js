!function(){var n=jQuery.event.special,t="D"+ +new Date,i="D"+(+new Date+1);n.scrollstart={setup:function(){var i,r=function(t){var r=this,u=arguments;i?clearTimeout(i):(t.type="scrollstart",jQuery.event.dispatch.apply(r,u));i=setTimeout(function(){i=null},n.scrollstop.latency)};jQuery(this).bind("scroll",r).data(t,r)},teardown:function(){jQuery(this).unbind("scroll",jQuery(this).data(t))}};n.scrollstop={latency:300,setup:function(){var t,r=function(i){var r=this,u=arguments;t&&clearTimeout(t);t=setTimeout(function(){t=null;i.type="scrollstop";jQuery.event.dispatch.apply(r,u)},n.scrollstop.latency)};jQuery(this).bind("scroll",r).data(i,r)},teardown:function(){jQuery(this).unbind("scroll",jQuery(this).data(i))}}}();!function(n,t,i,r){var u=n(t);n.fn.lazyload=function(f){function s(){var t=0;o.each(function(){var i=n(this);if((!e.skip_invisible||i.is(":visible"))&&!n.abovethetop(this,e)&&!n.leftofbegin(this,e))if(n.belowthefold(this,e)||n.rightoffold(this,e)){if(++t>e.failure_limit)return!1}else i.trigger("appear"),t=0})}var h,o=this,e={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:t,data_attribute:"original",skip_invisible:!1,appear:null,load:null,placeholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"};return f&&(r!==f.failurelimit&&(f.failure_limit=f.failurelimit,delete f.failurelimit),r!==f.effectspeed&&(f.effect_speed=f.effectspeed,delete f.effectspeed),n.extend(e,f)),h=e.container===r||e.container===t?u:n(e.container),0===e.event.indexOf("scroll")&&h.bind(e.event,function(){return s()}),this.each(function(){var i=this,t=n(i);i.loaded=!1;(t.attr("src")===r||t.attr("src")===!1)&&t.is("img")&&t.attr("src",e.placeholder);t.one("appear",function(){if(!this.loaded){if(e.appear){var r=o.length;e.appear.call(i,r,e)}n("<img />").bind("load",function(){var r=t.attr("data-"+e.data_attribute),u,f;t.hide();t.is("img")?t.attr("src",r):t.css("background-image","url('"+r+"')");t[e.effect](e.effect_speed);i.loaded=!0;u=n.grep(o,function(n){return!n.loaded});(o=n(u),e.load)&&(f=o.length,e.load.call(i,f,e))}).attr("src",t.attr("data-"+e.data_attribute))}});0!==e.event.indexOf("scroll")&&t.bind(e.event,function(){i.loaded||t.trigger("appear")})}),u.bind("resize",function(){s()}),/(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion)&&u.bind("pageshow",function(t){t.originalEvent&&t.originalEvent.persisted&&o.each(function(){n(this).trigger("appear")})}),n(i).ready(function(){s()}),this};n.belowthefold=function(i,f){var e;return e=f.container===r||f.container===t?(t.innerHeight?t.innerHeight:u.height())+u.scrollTop():n(f.container).offset().top+n(f.container).height(),e<=n(i).offset().top-f.threshold};n.rightoffold=function(i,f){var e;return e=f.container===r||f.container===t?u.width()+u.scrollLeft():n(f.container).offset().left+n(f.container).width(),e<=n(i).offset().left-f.threshold};n.abovethetop=function(i,f){var e;return e=f.container===r||f.container===t?u.scrollTop():n(f.container).offset().top,e>=n(i).offset().top+f.threshold+n(i).height()};n.leftofbegin=function(i,f){var e;return e=f.container===r||f.container===t?u.scrollLeft():n(f.container).offset().left,e>=n(i).offset().left+f.threshold+n(i).width()};n.inviewport=function(t,i){return!(n.rightoffold(t,i)||n.leftofbegin(t,i)||n.belowthefold(t,i)||n.abovethetop(t,i))};n.extend(n.expr[":"],{"below-the-fold":function(t){return n.belowthefold(t,{threshold:0})},"above-the-top":function(t){return!n.belowthefold(t,{threshold:0})},"right-of-screen":function(t){return n.rightoffold(t,{threshold:0})},"left-of-screen":function(t){return!n.rightoffold(t,{threshold:0})},"in-viewport":function(t){return n.inviewport(t,{threshold:0})},"above-the-fold":function(t){return!n.belowthefold(t,{threshold:0})},"right-of-fold":function(t){return n.rightoffold(t,{threshold:0})},"left-of-fold":function(t){return!n.rightoffold(t,{threshold:0})}})}(jQuery,window,document),function(){var n=angular.module("collectionWidget",["ngRoute","ui.bootstrap","cookyUserPopup"]),t;n.config(["UserPopupProvider",function(n){n.setOptions({textClass:"btnUserPopup",requestCount:10,loadMoreUrl:"",itemTemplateUrl:"/common/template/userpopupitem",containerClass:"user-popup-content"})}]);n.modal=new cModal;n.filter("getById",function(){return function(n,t){var i=0,r=n.length;for(i;i<r;i++)if(+n[i].Id==+t)return n[i];return null}});n.provider("collection",function(){var n={};return{setCurrent:function(t){n=t},$get:function(){return n}}});n.config(function(n){typeof initData!="undefined"&&n.setCurrent(initData)});n.ModalInstanceCtrl=function(n,t,i,r,u,f,e,o,s){t.ModeCaption=e;t.selected=r;t.ok=function(){var f=u?"/collection/update":"/collection/create";n.post(f,{model:r}).success(function(n){n.success?(u||(t.selected=n.result),i.close(t.selected),o?o(n):i.close(t.selected),r.errMsg=""):r.errMsg=n.msg}).error(function(){})};t.cancel=function(){s?s():i.dismiss("cancel")}};n.controller("QuickCreateCollection",["$location","$modal","$scope",function(t,i,r){this.showCreateForm=function(u){LoginHelper.RequiredLogin(function(){var f=i.open({templateUrl:"/ngtpl/collection-createform",controller:n.ModalInstanceCtrl,resolve:{selected:function(){return u?{id:scope.selectedItem.Id,title:scope.selectedItem.Title,description:scope.selectedItem.Description,isPublic:scope.selectedItem.IsPublic}:{isPublic:!0}},editMode:function(){return u},items:function(){return[]},ModeCaption:function(){return u?"Cập nhật thông tin":"Tạo bộ sưu tập"},okCallback:function(){return function(n){window.location=n.result.PrivateUrl}},cancelCallback:function(){return undefined}}});f.result.then(function(n){u?(scope.selectedItem.Title=n.title,scope.selectedItem.Description=n.description,scope.selectedItem.IsPublic=n.isPublic,r.selected={isPublic:!0}):(t.search({id:n.Id}),r.selected={isPublic:!0})})})}}]);n.controller("LikeController",["$http","$scope",function(n,t){var i=this;t.userLikes=[];typeof userLikes!="undefined"&&(t.userLikes=userLikes||[]);t.configLike=configLike;t.likeLoadMoreUrl="/recipe/getuserloadmore?recipeId="+recipeId+"&collectionId=2";t.recipeId=recipeId;t.totalLikes=0;t.init=function(n,i){t.isLiked=n;t.totalLikes=i};t.like=function(){LoginHelper.RequiredLogin(function(){n.post("/collection/like",{recipeId:t.recipeId,like:!t.isLiked}).success(function(n){n.success?(t.totalLikes=t.isLiked?parseInt(t.totalLikes)-1:parseInt(t.totalLikes)+1,t.isLiked=n.liked,t.configLike.text=t.totalLikes+" thích"):t.isLiked=n.liked})})};i.like=function(){t.like()};i.init=function(n,i){t.init(n,i)}}]);n.controller("CookController",["$http","$scope",function(n,t){t.userCooks=userCooks;t.configCook=configCook;t.cookLoadMoreUrl="/recipe/getuserloadmore?recipeId="+recipeId+"&collectionId=3";t.totalCook=0;t.isCooked=!1;t.recipeId=recipeId;t.init=function(n,i){t.isCooked=n;t.totalCook=i};t.cook=function(){LoginHelper.RequiredLogin(function(){n.post("/collection/cook",{recipeId:t.recipeId,cook:!t.isCooked}).success(function(n){n.success?(t.totalCook=t.isCooked?parseInt(t.totalCook)-1:parseInt(t.totalCook)+1,t.isCooked=n.cooked,t.configCook.text=t.totalCook):t.isCooked=n.cooked})})}}]);n.controller("PrintController",["$http",function(){var i=this,n=900,t=700,r=window.screenLeft?window.screenLeft:window.screenX,u=window.screenTop?window.screenTop:window.screenY,f=r+window.innerWidth/2-n/2,e=u+window.innerHeight/2-t/2;i.print=function(i){window.open(i,"Recipe Printing Viewer","toolbar=no, width="+n+", height="+t+", top="+e+", left="+f+"",1)}}]);n.directive("collectionWidgets",["$http",function(n){return{restrict:"EA",templateUrl:"/ngtpl/Collection-Widgets",controller:function(t,i){var r=this;r.recipeId=recipeId;r.isLoading=!1;r.collections=[];r.coreCollections=[];r.toggle=!1;r.open=function(){r.toggle=!0;r.toggle&&r.addListenerScrollElementEvent()};r.close=function(){r.toggle=!1};r.init=function(){r.toggle?r.close():r.coreCollections.length==0&&r.collections.length==0?(r.isLoading=!0,LoginHelper.RequiredLogin(function(){n.get("/collection/getlist/"+recipeId).success(function(n){r.collections=n.Items;r.coreCollections=n.CoreItems;r.isLoading=!1;r.open()}).error(function(){r.isLoading=!1})})):(r.coreCollections.length>0||r.collections.length>0)&&r.open()};r.Action=function(t){var i=t.IsExisted?"remove":"add";n.post("/collection/"+i,{id:t.Id,recipeId:r.recipeId}).success(function(n){t.IsExisted=n.success?i=="add"?!0:!1:n.result})};r.create=function(){};r.collectionModel={};r.errMsg="";r.createCollection=function(){r.errMsg="";n.post("/collection/create",{model:r.collectionModel,recipeId:r.recipeId}).success(function(n){n.success?r.collections.push(n.result):r.errMsg=n.msg;r.collectionModel={}}).error(function(){})};r.createCollectionByKeypress=function(n){n.which==13&&r.createCollection()};r.addListenerScrollElementEvent=function(){var n=$(i).data("scroll-eid");typeof n!="undefined"&&n!==null&&setTimeout(function(){$("#"+n).goTo("fast",200)},100)}},controllerAs:"cWidget"}}]);n.directive("collectionCreateWidget",["$http",function(n){return{restrict:"E",replace:!0,templateUrl:"/ngtpl/Collection-CreateForm",controller:function(){var t=this;t.recipeId=recipeId;t.isLoading=!0;t.collections=[];t.coreCollections=[];t.collectionModel={};t.errMsg="";t.createCollection=function(){t.errMsg="";n.post("/collection/create",{model:t.collectionModel,recipeId:t.recipeId}).success(function(n){n.success?t.collections.push(n.result):t.errMsg=n.msg;t.collectionModel={}}).error(function(){})}},controllerAs:"cCreateWidget"}}]);n.controller("CollectionMemberController",["$http","$location","$rootScope","$filter","$modal","$scope","collection",function(t,i,r,u,f,e,o){var s=this;s.selectedId=i.search().id?i.search().id:1;s.currentUserId=o.UserId;s.owner=o.UserId;s.systemItems=o.SystemItems;s.coreItems=o.CoreItems;s.items=o.Items;s.pageSize=20;s.pageable=function(){return s.selectedItem.RecipeListModel!=null&&s.selectedItem.TotalCount>s.selectedItem.RecipeListModel.Items.length};s.selectedItem={};s.setSelectedId=function(){s.selectedId=i.search().id?i.search().id:1};s.isDetailModel=function(){return i.search().id?!0:!1};s.removeable=o.IsRemoveable;s.setSelectedItem=function(n,t){var i=u("getById")(t,n);i!=null&&(i.showConfig=function(){return!i.IsSystem&&!i.IsCore&&s.removeable},s.selectedItem=i)};s.buildRecipeModel=function(n){return n};s.init=function(n){t.get("/collection/getrecipesbyid?id="+n+"&userId="+s.owner+"&pageIndex="+s.selectedItem.RecipeListModel.Page+"&pageSize="+s.selectedItem.RecipeListModel.PageSize).success(function(n){if(n.success){s.selectedItem.RecipeListModel.TotalCount=n.result.TotalCount;for(var t=0;t<n.result.Items.length;t++)s.selectedItem.RecipeListModel.Items.push(s.buildRecipeModel(n.result.Items[t]))}})};s.loadMore=function(){t.get("/collection/getrecipesbyid?id="+s.selectedItem.Id+"&userId="+s.owner+"&pageIndex="+s.selectedItem.RecipeListModel.Page+1+"&pageSize="+s.selectedItem.RecipeListModel.PageSize).success(function(n){if(n.success){s.selectedItem.RecipeListModel.Page++;s.selectedItem.RecipeListModel.Page=n.result.TotalCount;for(var t=0;t<n.result.Items.length;t++)s.selectedItem.RecipeListModel.Items.push(s.buildRecipeModel(n.result.Items[t]))}})};r.$on("$locationChangeSuccess",function(){var n=i.$$path,t=n=="/s"||n==""?s.systemItems:s.items;s.setSelectedId();s.setSelectedItem(s.selectedId,t);s.selectedItem.RecipeListModel&&s.selectedItem.RecipeListModel.TotalCount==0&&s.init(s.selectedId)});s.link=function(n,t){return t+"?id="+n.Id};s.remove=function(i){n.modal.confirmPopup("Xóa công thức khỏi bộ sưu tập","Xác nhận xóa công thức này khỏi bộ sưu tập",function(){t.post("/collection/remove",{id:s.selectedId,recipeId:s.selectedItem.RecipeListModel.Items[i].Id}).success(function(t){t.success?(s.selectedItem.RecipeListModel.Items.splice(i,1),s.selectedItem.TotalCount--,s.selectedItem.RecipeListModel.TotalCount--,n.modal.close()):n.modal.close()})})};s.delete=function(){n.modal.confirmPopup("Xác nhận xóa bộ sưu tập","Bạn muốn khỏi bộ sưu tập. Tất cả công thức cũng sẽ bị xóa khỏi bộ sưu tập này. Vui lòng xác nhận!",function(){t.post("/collection/delete",{id:s.selectedItem.Id}).success(function(t){if(t.success){var r=s.items.indexOf(s.selectedItem);s.items.splice(r,1);s.selectedItem=i.search({id:r==0?s.systemItems[0].Id:s.items[r-1].Id});n.modal.close()}else n.modal.messagePopup("Lỗi",t.msg)})})};e.selected={};e.ModeCaption="Cập nhật thông tin";s.showCreateForm=function(t){LoginHelper.RequiredLogin(function(){var r=f.open({templateUrl:"/ngtpl/collection-createform",controller:n.ModalInstanceCtrl,resolve:{selected:function(){return t?{id:s.selectedItem.Id,title:s.selectedItem.Title,description:s.selectedItem.Description,isPublic:s.selectedItem.IsPublic}:{isPublic:!0}},editMode:function(){return t},items:function(){return s.items},ModeCaption:function(){return t?"Cập nhật thông tin":"Tạo bộ sưu tập"},okCallback:function(){return function(n){t||(s.items.push(n.result),window.location=n.result.PrivateUrl)}},cancelCallback:function(){return undefined}}});r.result.then(function(n){t?(s.selectedItem.Title=n.title,s.selectedItem.Description=n.description,s.selectedItem.IsPublic=n.isPublic,e.selected={}):(i.search({id:n.Id}),e.selected={})})})}}]);n.config(["$routeProvider","$locationProvider",function(n,t){n.when("/u?id=:id",{templateUrl:"collectionDetailTpl.html",controller:"CollectionMemberController",controllerAs:"cMemberCtrl"});t.html5Mode({enabled:!0,requireBase:!0}).hashPrefix("!")}]);reportApp=angular.module("reportControllerApp",["ngRoute","ui.bootstrap"]);reportApp.modal=new cModal;reportApp.provider("reportObject",function(){var n={};return{setCurrent:function(t){n=t},$get:function(){return n}}});reportApp.filter("to_trusted_html",["$sce",function(n){return function(t){return n.trustAsHtml(t)}}]);reportApp.controller("ReportController",["$http","$scope","$location","$modal","reportObject",function(n,t,i,r){var u=this,f;u.highlight=!0;t.modalOpened=!1;f=null;u.report=function(n,i,e){t.modalOpened||LoginHelper.RequiredLogin(function(){u.selectedItem={Id:n,Title:i,Selection:window.getSelection().toString(),ObjectType:1,ErrMsg:null,Valid:!0,Success:!1};var o={ReferenceId:u.selectedItem.Id,ReferenceType:e||u.selectedItem.ObjectType},s=$.ajax({url:"/Common/UserReportChecking",data:JSON.stringify(o),type:"POST",contentType:"application/json",beforeSend:function(){},success:function(n){n.Message&&n.Message.length>0&&(u.selectedItem.ErrMsg=n.Message,u.selectedItem.Valid=!1)},error:function(){}}).done(function(){f=r.open({templateUrl:"/ngtpl/report-createform",controller:reportApp.ModalInstanceCtrl,resolve:{ModeCaption:function(){return"Báo lỗi cho"},reportObject:function(){return{id:u.selectedItem.Id,title:u.selectedItem.Title,selection:u.selectedItem.Selection,objectType:e||u.selectedItem.ObjectType,errMsg:u.selectedItem.ErrMsg,valid:u.selectedItem.Valid,success:u.selectedItem.Success}},okCallback:function(){return function(){}},cancelCallback:function(){return undefined}}});f.opened.then(function(){t.modalOpened=!0});f.result.then(function(){t.modalOpened=!1;f=null},function(){t.modalOpened=!1;f=null})})})}}]);reportApp.ModalInstanceCtrl=["$http","$scope","$modalInstance","ModeCaption","reportObject","okCallback","cancelCallback",function(n,t,i,r,u,f,e){t.ModeCaption=r;t.selected=u;t.valid=function(){return t.selected.id<1?(t.selected.errMsg="Không tìm thấy đối tượng được báo lỗi, vui lòng thử lại!",!1):t.selected.description==undefined||t.selected.description.length==0?(t.selected.errMsg="Bạn chưa nhập nội dung báo lỗi!",!1):!0};t.ok=function(){if(t.valid()){var n={ReferenceId:t.selected.id,ReferenceType:t.selected.objectType,Content:t.selected.description,Selection:t.selected.selection};$.ajax({url:"/Common/UserReport",data:JSON.stringify(n),type:"POST",contentType:"application/json",beforeSend:function(){t.selected.loading=!0},success:function(i){i.Message&&i.Message.length>0?t.selected.errMsg=i.Message:(f&&f(n),t.selected.errMsg="Nội dung của bạn đang chờ duyệt. Cám ơn bạn đã quan tâm và chia sẻ đến Cooky.vn!",t.selected.success=!0)},error:function(){t.selected.errMsg="Nội dung báo lỗi chưa được gửi, vui lòng thử lại."}}).done(function(){t.selected.loading=!1;t.$apply()})}};t.cancel=function(){e?e():i.dismiss("cancel")}}];t=angular.element(document.getElementById("cooky-report")).scope();typeof t=="undefined"&&document.getElementById("cooky-report")&&angular.bootstrap(document.getElementById("cooky-report"),["reportControllerApp"])}();var articleApp=angular.module("articleApp",["cookyLikeComment","cookyWidgetApp","reportControllerApp"]);articleApp.controller("CommentController",["$http","$scope",function(n,t){t.recallFunc=function(n){typeof n!="undefined"&&n!=null&&n()}}]);Object.deepExtend=function(n,t){for(var i in t)t[i]&&t[i].constructor&&t[i].constructor===Object?(n[i]=n[i]||{},arguments.callee(n[i],t[i])):n[i]=t[i];return n};$(".article-recipe-add").unbind("click").click(function(){var n=$(this).position().left,t=$(this).position().top,i=$(this).attr("articleId");$(".article-add-collection-content").html().trim()||$.ajax({url:"/Blog/RecipeMapping/",type:"post",data:{articleId:i},success:function(n){$(".article-add-collection-content").html(n)}});$(".article-add-collection-content").css("display")=="none"?($(".article-add-collection-content").css("position","absolute"),$(".article-add-collection-content").css("left",n),$(".article-add-collection-content").css("top",t+20),$(".article-add-collection-content").show()):($(".article-add-collection-content").css("position","absolute"),$(".article-add-collection-content").css("left",n),$(".article-add-collection-content").css("top",t+20),$(".article-add-collection-content").hide())});articleApp.run(["$rootScope","$http",function(n,t){n.QuestionStats=[];n.QuizTotal=[];n.QuizResult=function(){var r=0,i=0,t=n.QuestionStats.length;return t>0?(n.QuestionStats.forEach(function(n){n.selected&&r++;n.result&&i++}),{completed:r==t,result:i||0,length:t||0}):{completed:!1,result:i||0,length:t||0}};n.QuizResultMessage="";n.GetLocalizationMessage=function(t,i){var r=t/i*100;n.QuizResultMessage=r>=80?"Wao!!! Bạn xứng đáng là một master chef thực thụ rồi đó! Quá tuyệt vời!":r>=50?"Kiến thức về ẩm thực của bạn tương đối tốt, hãy tìm hiểu thêm cho mình những thông tin bổ ích nhé!":"Ôi không!!! bạn cần cập nhật ngay kiến thức ẩm thực đi nha! Thường xuyên cập nhật thông tin trên Cooky để trở thành 1 chuyên gia nào!"};n.Init=function(){typeof articleid!="undefined"&&articleid>0&&t({method:"GET",url:"/quiz/GetTotal?articleid="+articleid}).success(function(t){if(t.Result)for(var i=0;i<t.Result.length;i++)n.QuizTotal.push(t.Result[i])}).then(function(){var i,t;if(n.QuizTotal.length>0){for(i=[],t=0;t<n.QuizTotal.length;t++)i.push({question:n.QuizTotal[t].QuestionId,answer:n.QuizTotal[t].AnswerId,result:n.QuizTotal[t].IsResult,selected:!0});n.QuestionStats=i}})};n.Init();LoginHelper.LoginSuccessCallBack=function(){window.location.reload()};n.CustomerDisplayName="";n.sharer=function(){LoginHelper.RequiredLogin(function(){var i=null,r="";typeof metainfo!==undefined&&(i=metainfo.imageUrl,r=metainfo.title);t({method:"GET",url:"/member/GetCurrentUserInfo"}).success(function(t){t.data&&(n.CustomerDisplayName=t.data.DisplayName)}).then(function(){var t=parseInt($("#quiz-result-count").text()||0),u=parseInt($("#quiz-result-total").text()||0);FB.ui({method:"feed",name:n.CustomerDisplayName+" đã trả lời đúng ["+t+"/"+u+"] câu trắc nghiệm",link:window.location.href,picture:i||"https://www.cooky.vn/imgs/cooky-logo-1024.jpg",caption:"Trắc nghiệm ẩm thực",description:"Bạn tự tin vào kiến thức ẩm thực của mình! Bạn là một nội trợ tài ba! Tham gia trắc nghiệm kiến thức ẩm thực cùng Cooky ngay thôi! "+r,message:"",author:"https://www.facebook.com/cooky.vn"})})})};n.totalLikes=0;n.liked=!1;n.initLike=function(t,i){n.totalLikes=t;n.liked=i};n.isPostingLike=!1;n.like=function(i,r){LoginHelper.RequiredLogin(function(){n.isPostingLike||(n.isPostingLike=!0,t({method:"POST",url:"/like/"+i+"/"+r,data:{}}).success(function(t){t.success&&(n.totalLikes=t.totalLike,n.liked=t.likeExits>0?!0:!1);n.isPostingLike=!1}))})}}]);articleApp.directive("quizQuestionWidgets",["$http","$log","$rootScope","$timeout",function(n,t,i){return{restrict:"AEC",replace:!0,scope:{id:"@id",name:"@name"},templateUrl:"/ngtpl/article-quizwidgets",link:function(t,r){if(r.removeAttr("href"),t.questionId=t.id||t.name,t.Selected=!1,t.checked=!1,t.isresult=!1,t.initAnswers=function(i){n({method:"GET",url:"/quiz/getanswers?qid="+t.questionId}).success(function(n){var r=[],i;if(n.Result)for(i=0;i<n.Result.length;i++)r.push(n.Result[i]);t.ans=r}).error(function(){}).then(function(){if(t.ans.length>0){var n=!1;t.ans.forEach(function(i){i.Selected&&(n=!0,t.Selected=!0)});t.checked=n}i&&i()})},t.doAnswer=function(i,r){n({method:"POST",url:"/quiz/doanswer",data:{qid:t.questionId,ansid:i.Id}}).success(function(n){var u=[],r;if(n.Optional==-1)LoginHelper.RequiredLogin(function(){window.location.reload()}),t.Selected=!1,i.Selected=!1;else{if(n.Result)for(r=0;r<n.Result.length;r++)u.push(n.Result[r]);$.extend(t.ans,u);t.checked=!0;t.isresult=n.Optional||!1}}).error(function(){}).then(function(){r&&r()})},t.ans=[],t.initAnswers(function(){var n=i.QuizResult();t.displayResult(n.completed,n.result,n.length)}),i.QuestionStats.length>0){var u=!1;i.QuestionStats.forEach(function(n){n.question==t.questionId&&(u=!0)});u||i.QuestionStats.push({question:t.questionId})}else i.QuestionStats.push({question:t.questionId});t.cssIcon=function(n){return t.Selected&&t.checked?n.Selected?n.IsResult?"fa fa-circle success":"fa fa-circle-thin fail":n.IsResult?"fa fa-circle success":"":""};t.cssName=function(n){return t.Selected&&t.checked?n.Selected?n.IsResult?"success":"fail":n.IsResult?"success":"":""};t.doAns=function(n){t.Selected||(t.Selected=!0,n.Selected=!0,t.doAnswer(n,function(){var u=[],r;i.QuestionStats.forEach(function(i){i.question==t.questionId?u.push({question:t.questionId,answer:n.Id,name:n.Name,result:t.isresult,selected:!0}):u.push(i)});$.extend(i.QuestionStats,u);r=i.QuizResult();t.displayResult(r.completed,r.result,r.length)}))};t.showDesc=function(){return t.checked};t.displayResult=function(n,t,r){n?($(".quiz-result-block").show(),$("#quiz-result-count").text(t),$("#quiz-result-total").text(r),i.GetLocalizationMessage(t,r),$("#quiz-result-message").text(i.QuizResultMessage)):$(".quiz-result-block").hide()}}}}])